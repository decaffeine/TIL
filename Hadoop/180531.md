# 180531 

### 네임노드와 데이터노드  
HDFS는 master-slave architecture  
```
master : NameNode  
slave : DataNode  
```
[그림]

### 보조네임노드   
NameNode는 메타데이터를 메모리에서 처리한다.  
이 메타데이터의 유실 방지를 위해 editslog와 fsimage라는 파일을 생성  
(editslog : HDFS의 모든 변경 이력 저장, fsimage : 메모리에 저장된 메타데이터의 파일 시스템 이미지 저장)  
보조네임노드를 통해 주기적으로 네임노드의 fsimage를 갱신 (checkpoint 작업)  
checkpoint 작업은 기본적으로 1시간마다 한 번씩 일어남

### 분석용 데이터  

http://stat-computing.org/dataexpo/2009/  
1987년 다운로드  
홈 디렉토리의 dataexpo 폴더에 옮기기  

### HDFS 명령어  

hdfs상의 모든 파일과 디렉토리 표시
```
hdfs dfs -ls -R /
```

/에 input이라는 디렉토리 만들기 
```
hdfs dfs -mkdir /input
```

현재 폴더의 1987.csv를 hdfs상의 가상 폴더인 input으로 올리기
```
hdfs dfs -put ./1987.csv /input
```

hdfs상의 input/1987.csv를 실제 폴더로 내리기
```
hdfs dfs -get /input/1987.csv
```

- Linux 명령어 cat, tail  
```
cat : 파일의 내용 출력
tail : 파일의 끝부분 출력
```

hadoop에서도 똑같이 쓸 수 있다.  

```
hdfs dfs -tail /input/1987.csv 
hdfs dfs -cat /input/1987.csv | tail -10
hdfs dfs -cat /input/1987.csv | head -10

```

파일 삭제하기  
```
hdfs dfs -rm /input/1987.csv
hdfs dfs -rm -R /input/1987.csv
```
-R 옵션 : 폴더까지 같이 지울 때  

#### 새 프로젝트 : big_01_HDFS_IN_OUT

```
New Maven Project
maven-quickstart
Group Id : com.sist
Artifact Id : big_01_HDFS_IN_OUT

```

기존 pom.xml 가져오기  

- 라이브러리 추가  
```xml

 	<properties>
 			<org.springframework.data.version>2.4.0.RELEASE</org.springframework.data.version>
 			<org.apache.hadoop.version>2.8.0</org.apache.hadoop.version>
	</properties>

	<dependencies>
	
	<!--  hadoop-spring-data -->
	<!-- https://mvnrepository.com/artifact/org.springframework.data/spring-data-hadoop -->
<dependency>
    <groupId>org.springframework.data</groupId>
    <artifactId>spring-data-hadoop</artifactId>
    <version>${org.springframework.data.version}</version>
</dependency>
	
	<!--  Hadoop Client -->
	<!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-client -->
<dependency>
    <groupId>org.apache.hadoop</groupId>
    <artifactId>hadoop-client</artifactId>
    <version>${org.apache.hadoop.version}</version>
</dependency>

	</dependencies>

```

https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-client/2.8.0  
https://mvnrepository.com/artifact/org.springframework.data/spring-data-hadoop/2.4.0.RELEASE  

#### 작업 순서  
0. (Hadoop 실행중)  
1. Java Coding  
2. Jar로 압축  
3. NameNode에서 실행  
